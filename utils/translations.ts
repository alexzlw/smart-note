
import { Language, Subject, MasteryLevel } from '../types';

type TranslationKey = 
  | 'app_name' | 'app_desc' | 'dashboard' | 'review_notes' | 'settings'
  | 'login_google' | 'logout' | 'syncing' | 'add_mistake' | 'keep_going'
  | 'keep_going_desc' | 'stats_analysis' | 'stats_desc' | 'total_mistakes'
  | 'mastered' | 'review_needed' | 'subject_breakdown' | 'mastery_status'
  | 'no_mistakes_yet' | 'add_first_mistake' | 'my_notebook' | 'notebook_desc'
  | 'search_placeholder' | 'all_subjects' | 'all_statuses' | 'no_results'
  | 'no_results_cloud' | 'no_results_filter' | 'subject' | 'memo_optional'
  | 'memo_placeholder' | 'correct_answer_required' | 'correct_answer_placeholder'
  | 'upload_photo' | 'drag_drop' | 'cancel' | 'save' | 'saving'
  | 'reflection_title' | 'reflection_placeholder' | 'text_mode' | 'draw_mode'
  | 'tap_to_edit' | 'add_handwriting' | 'correct_answer_label' | 'ai_solution'
  | 'analysis_points' | 'similar_question' | 'close' | 'generate_similar'
  | 'creating' | 'show_answer' | 'hide' | 'create_ai_analysis' | 'regenerate_ai' | 'analyzing'
  | 'delete' | 'delete_confirm' | 'quota_error' | 'analysis_error'
  | 'language_settings' | 'data_management' | 'export_backup' | 'export_desc'
  | 'download_json' | 'import_restore' | 'import_desc' | 'select_file'
  | 'import_success' | 'import_error' | 'danger_zone' | 'delete_all_data'
  | 'delete_all_confirm' | 'deleted' | 'optimize_image' | 'save_error'
  | 'custom_prompt_title' | 'custom_prompt_desc' | 'custom_prompt_placeholder' | 'save_settings';

const resources: Record<Language, Record<TranslationKey, string>> = {
  ja: {
    app_name: 'SmartNote',
    app_desc: 'AI間違いノート',
    dashboard: 'データ分析',
    review_notes: '間違いノート',
    settings: '設定',
    login_google: 'Googleでログイン',
    logout: 'ログアウト',
    syncing: 'クラウド同期中',
    add_mistake: '間違いを追加',
    keep_going: '継続は力なり！',
    keep_going_desc: '間違いを追加して、分析を充実させましょう。',
    stats_analysis: '学習データの分析',
    stats_desc: '学習の進捗状況を一目で確認できます。',
    total_mistakes: '間違い総数',
    mastered: '完了 (習得済み)',
    review_needed: '復習が必要',
    subject_breakdown: '科目別内訳',
    mastery_status: '習得状況',
    no_mistakes_yet: '間違いを追加して、分析を開始しましょう！',
    add_first_mistake: '最初の間違いを追加する',
    my_notebook: 'マイノート',
    notebook_desc: '知識の隙間を埋めて、苦手を克服しましょう。',
    search_placeholder: '検索...',
    all_subjects: '全科目',
    all_statuses: '全ステータス',
    no_results: '間違いが見つかりません',
    no_results_cloud: 'クラウドにはまだデータがありません。',
    no_results_filter: '現在のフィルターに一致する問題はありません。',
    subject: '科目',
    memo_optional: 'メモ (任意)',
    memo_placeholder: '例: p.32 問3',
    correct_answer_required: '正解 (必須)',
    correct_answer_placeholder: '正しい答えを入力してください...',
    upload_photo: '写真をアップロード',
    drag_drop: 'クリックまたはドラッグ＆ドロップ',
    cancel: 'キャンセル',
    save: '保存する',
    saving: '保存中...',
    reflection_title: '振り返り・反省メモ',
    reflection_placeholder: 'なぜ間違えた？次はどうする？（例：計算ミス。途中式を丁寧に書く）',
    text_mode: 'テキスト入力',
    draw_mode: '手書き入力',
    tap_to_edit: 'タップして編集',
    add_handwriting: '手書きメモを追加する',
    correct_answer_label: '正解 (あなたのメモ)',
    ai_solution: 'AI 解説',
    analysis_points: '分析・ポイント',
    similar_question: '類題で確認！',
    close: '閉じる',
    generate_similar: '類題にチャレンジする',
    creating: '作成中...',
    show_answer: '答えを見る',
    hide: '隠す',
    create_ai_analysis: 'AI解説を作成',
    regenerate_ai: 'AI解説を再生成',
    analyzing: '解析中...',
    delete: '削除',
    delete_confirm: 'この間違いノートを削除しますか？\n（この操作は元に戻せません）',
    quota_error: '⚠️ 利用制限(Quota)に達しました。しばらく時間を置いてから再度お試しください。',
    analysis_error: '⚠️ 分析に失敗しました。もう一度お試しください。',
    language_settings: '言語設定 (Language)',
    data_management: 'データ管理',
    export_backup: 'バックアップ (エクスポート)',
    export_desc: '全ての間違いノートと画像を1つのファイルとしてダウンロードします。',
    download_json: 'JSONファイルをダウンロード',
    import_restore: '復元 (インポート)',
    import_desc: '以前にダウンロードしたバックアップファイルをアップロードして、データを復元します。',
    select_file: 'ファイルを選択',
    import_success: '正常に復元されました！',
    import_error: 'インポートに失敗しました。',
    danger_zone: '危険エリア',
    delete_all_data: 'すべてのデータを削除',
    delete_all_confirm: '本当によろしいですか？すべてのデータが永久に削除されます。',
    deleted: '削除しました',
    optimize_image: '画像を最適化中...',
    save_error: '保存中にエラーが発生しました。',
    custom_prompt_title: 'AIへの指示 (プロンプト)',
    custom_prompt_desc: 'AIにどのような解説をしてほしいか、指示をカスタマイズできます。空欄の場合はデフォルト設定が使用されます。',
    custom_prompt_placeholder: '例：小学生にもわかるように優しく教えて。 / 文法事項を中心に解説して。 / 答えだけでなく途中式を詳しく書いて。',
    save_settings: '設定を保存'
  },
  en: {
    app_name: 'SmartNote',
    app_desc: 'AI Error Notebook',
    dashboard: 'Analytics',
    review_notes: 'My Notebook',
    settings: 'Settings',
    login_google: 'Login with Google',
    logout: 'Logout',
    syncing: 'Cloud Sync Active',
    add_mistake: 'Add Mistake',
    keep_going: 'Consistency is Key!',
    keep_going_desc: 'Add mistakes to improve your analysis.',
    stats_analysis: 'Learning Analytics',
    stats_desc: 'Track your learning progress at a glance.',
    total_mistakes: 'Total Mistakes',
    mastered: 'Mastered',
    review_needed: 'Needs Review',
    subject_breakdown: 'Subject Breakdown',
    mastery_status: 'Mastery Status',
    no_mistakes_yet: 'Add a mistake to start analyzing!',
    add_first_mistake: 'Add First Mistake',
    my_notebook: 'My Notebook',
    notebook_desc: 'Fill knowledge gaps and overcome weaknesses.',
    search_placeholder: 'Search...',
    all_subjects: 'All Subjects',
    all_statuses: 'All Statuses',
    no_results: 'No mistakes found',
    no_results_cloud: 'No data in the cloud yet.',
    no_results_filter: 'No questions match the current filters.',
    subject: 'Subject',
    memo_optional: 'Note (Optional)',
    memo_placeholder: 'Ex: p.32 Q3',
    correct_answer_required: 'Correct Answer (Required)',
    correct_answer_placeholder: 'Enter the correct answer...',
    upload_photo: 'Upload Photo',
    drag_drop: 'Click or Drag & Drop',
    cancel: 'Cancel',
    save: 'Save',
    saving: 'Saving...',
    reflection_title: 'Reflection / Self-correction',
    reflection_placeholder: 'Why was it wrong? What to do next? (e.g., Calculation error. Write steps carefully)',
    text_mode: 'Text Input',
    draw_mode: 'Handwriting',
    tap_to_edit: 'Tap to edit',
    add_handwriting: 'Add Handwriting',
    correct_answer_label: 'Correct Answer (Your Note)',
    ai_solution: 'AI Solution',
    analysis_points: 'Key Points',
    similar_question: 'Practice Similar Question!',
    close: 'Close',
    generate_similar: 'Challenge Similar Question',
    creating: 'Creating...',
    show_answer: 'Show Answer',
    hide: 'Hide Answer',
    create_ai_analysis: 'Get AI Analysis',
    regenerate_ai: 'Regenerate Analysis',
    analyzing: 'Analyzing...',
    delete: 'Delete',
    delete_confirm: 'Are you sure you want to delete this note?\n(This cannot be undone)',
    quota_error: '⚠️ Quota limit reached. Please try again in a moment.',
    analysis_error: '⚠️ Analysis failed. Please try again.',
    language_settings: 'Language Settings',
    data_management: 'Data Management',
    export_backup: 'Backup (Export)',
    export_desc: 'Download all notes and images as a single file.',
    download_json: 'Download JSON',
    import_restore: 'Restore (Import)',
    import_desc: 'Upload a backup file to restore your data.',
    select_file: 'Select File',
    import_success: 'Restored successfully!',
    import_error: 'Import failed.',
    danger_zone: 'Danger Zone',
    delete_all_data: 'Delete All Data',
    delete_all_confirm: 'Are you sure? All data will be permanently deleted.',
    deleted: 'Deleted',
    optimize_image: 'Optimizing image...',
    save_error: 'Error occurred while saving.',
    custom_prompt_title: 'Custom AI Instructions (Prompt)',
    custom_prompt_desc: 'Customize how the AI explains problems. Leave blank to use default settings.',
    custom_prompt_placeholder: 'E.g., Explain like I\'m 5. / Focus on grammar. / Show detailed calculation steps.',
    save_settings: 'Save Settings'
  },
  zh: {
    app_name: '智能错题本',
    app_desc: 'AI 错题分析助手',
    dashboard: '数据分析',
    review_notes: '错题复习',
    settings: '设置',
    login_google: 'Google 登录',
    logout: '退出登录',
    syncing: '云端同步中',
    add_mistake: '添加错题',
    keep_going: '坚持就是胜利！',
    keep_going_desc: '多添加错题，分析更精准。',
    stats_analysis: '学习数据分析',
    stats_desc: '一目了然地查看学习进度。',
    total_mistakes: '错题总数',
    mastered: '已掌握',
    review_needed: '需复习',
    subject_breakdown: '科目分布',
    mastery_status: '掌握程度',
    no_mistakes_yet: '添加你的第一道错题来开始分析！',
    add_first_mistake: '添加第一道错题',
    my_notebook: '我的错题本',
    notebook_desc: '填补知识漏洞，攻克薄弱环节。',
    search_placeholder: '搜索...',
    all_subjects: '全科目',
    all_statuses: '全状态',
    no_results: '未找到错题',
    no_results_cloud: '云端暂无数据。',
    no_results_filter: '没有符合当前筛选条件的问题。',
    subject: '科目',
    memo_optional: '备注 (选填)',
    memo_placeholder: '例: 第32页 第3题',
    correct_answer_required: '正确答案 (必填)',
    correct_answer_placeholder: '请输入正确答案...',
    upload_photo: '上传照片',
    drag_drop: '点击或拖拽上传',
    cancel: '取消',
    save: '保存',
    saving: '保存中...',
    reflection_title: '反思与总结',
    reflection_placeholder: '为什么错了？下次怎么做？（例：计算粗心，以后要写清步骤）',
    text_mode: '文本输入',
    draw_mode: '手写输入',
    tap_to_edit: '点击编辑',
    add_handwriting: '添加手写笔记',
    correct_answer_label: '正确答案 (你的笔记)',
    ai_solution: 'AI 解析',
    analysis_points: '分析与考点',
    similar_question: '举一反三！',
    close: '关闭',
    generate_similar: '挑战类似题目',
    creating: '生成中...',
    show_answer: '查看答案',
    hide: '隐藏答案',
    create_ai_analysis: '生成 AI 解析',
    regenerate_ai: '重新生成解析',
    analyzing: '解析中...',
    delete: '删除',
    delete_confirm: '确定要删除这条错题吗？\n（此操作无法撤销）',
    quota_error: '⚠️ 达到使用限制(Quota)。请稍后再试。',
    analysis_error: '⚠️ 分析失败，请重试。',
    language_settings: '语言设置 (Language)',
    data_management: '数据管理',
    export_backup: '备份 (导出)',
    export_desc: '将所有错题和图片下载为一个文件。',
    download_json: '下载 JSON 文件',
    import_restore: '恢复 (导入)',
    import_desc: '上传备份文件以恢复数据。',
    select_file: '选择文件',
    import_success: '恢复成功！',
    import_error: '导入失败。',
    danger_zone: '危险区域',
    delete_all_data: '删除所有数据',
    delete_all_confirm: '确定吗？所有数据将被永久删除。',
    deleted: '已删除',
    optimize_image: '图片优化中...',
    save_error: '保存时发生错误。',
    custom_prompt_title: '自定义 AI 指令 (Prompt)',
    custom_prompt_desc: '您可以自定义 AI 讲解题目的方式。留空则使用默认设置。',
    custom_prompt_placeholder: '例：像给小学生讲课一样解释。 / 重点分析语法。 / 不要只给答案，要列出详细计算步骤。',
    save_settings: '保存设置'
  }
};

export const getSubjectLabel = (subject: Subject, lang: Language): string => {
  const map: Record<Subject, Record<Language, string>> = {
    [Subject.KOKUGO]: { ja: '国語', en: 'Japanese/Language', zh: '语文' },
    [Subject.SANSU]: { ja: '算数', en: 'Math', zh: '数学' },
    [Subject.RIKA]: { ja: '理科', en: 'Science', zh: '科学' },
    [Subject.SHAKAI]: { ja: '社会', en: 'Social Studies', zh: '社会' },
    [Subject.OTHER]: { ja: 'その他', en: 'Other', zh: '其他' }
  };
  return map[subject][lang];
};

export const getMasteryLabel = (level: MasteryLevel, lang: Language): string => {
  const map: Record<MasteryLevel, Record<Language, string>> = {
    [MasteryLevel.NEW]: { ja: '未習得', en: 'New', zh: '未掌握' },
    [MasteryLevel.REVIEWING]: { ja: '復習中', en: 'Reviewing', zh: '复习中' },
    [MasteryLevel.MASTERED]: { ja: '完了', en: 'Mastered', zh: '已掌握' }
  };
  return map[level][lang];
};

export const t = (key: TranslationKey, lang: Language): string => {
  return resources[lang][key] || resources['ja'][key] || key;
};
